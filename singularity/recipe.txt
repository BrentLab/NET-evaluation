Bootstrap: docker
From: ubuntu:18.04

%help
    Image for running NET-evaluation package
    Brent Lab, Washington University in Saint Louis

%post
    # update OS
    apt-get update
    apt-get upgrade -y
    apt-get install -y tzdata
    
    # python
    apt-get install python3.6 -y
    apt install python3-pip -y
    pip3 install pandas

    # webgestalt
    apt-get install libcurl4-openssl-dev -y
    apt-get install libssl-dev -y
    apt-get install cmake libfreetype6-dev libfontconfig1-dev xclip -y
    apt-get install libcairo2-dev libjpeg-dev libgif-dev -y
    apt-get install r-base -y
    R --slave -e 'install.packages("WebGestaltR")'
    R --slave -e 'install.packages("rjson")'
    R --slave -e 'install.packages("optparse")'

    # perl, first install WebGestaltR coz there are packages
    # that perl depends on them for installing GO Term finder
    apt-get install perl-base
    apt-get upgrade perl -y
    
    # GO-TermFinder
    cd /home/packages/
    tar -xf GO-TermFinder-0.86.tar
    cd GO-TermFinder-0.86
    perl Makefile.PL
    make
    make install
    
%files
    ../../NET-evaluation /home/
    ../toy_example /home/
    ../packages /home/


# to build this container, compress, and extract
# sudo singularity build --sandbox s_neteval recipe.txt
# sudo tar -czf --hard-dereference s_neteval.tar.gz s_neteval
# tar -xf s_neteval.tar.gz
